@if(eventDetails){
<div class="container-fluid bg-white">
    <div class="row g-0">
        <div class="col-12 d-flex flex-column justify-content-center align-items-center">
            <div class="col-8 d-flex gap-4 align-items-center  ">
                <div class="col-7 py-3 description_movie_section">
                    <h3>{{eventDetails?.name}}</h3>
                </div>
                <div class="col-4">
                    <i class="fa fa-share me-2" aria-hidden="true"></i>
                    <span (click)="openShareModal(shareModal)">Share</span>
                </div>
            </div>
            <div class="col-8 d-flex justify-content-start gap-5 align-items-start">
                <div class="col-8 py-3 card_image">
                    <img class="w-100 oject-fill rounded-4 h-100"
                        [src]="commonService.getImageFromBase64(eventDetails?.imageurl)" [alt]="eventDetails?.imageurl">
                    <!-- bottom_text -->
                    <div class="d-flex justify-content-center align-items-start  py-4">
                        <div class="col-8 d-flex gap-2 poster_bottom_txt">
                            <p>{{eventDetails?.categories}}</p>
                        </div>
                        <div class="col-4 text-end ">
                            <p class="likes_interested"> <i class="fa fa-thumbs-up me-1 text-success"
                                    aria-hidden="true"></i>{{eventDetails?.likes?? 0| numberFormat}} are interested
                            </p>
                        </div>
                    </div>
                    <!-- about events -->
                    <h3>About the Events</h3>
                    <p class="w-75">{{eventDetails?.description}}</p>
                    <h3>You Should know</h3>
                    <div class="div w-75 rounded-4 d-flex align-items-center p-4 shadow-sm you_should_know_text">
                        <i class="fa fa-lightbulb-o fs-1 text-danger" aria-hidden="true"></i>
                        <p class="px-3 my-0"> Seating is on a first come first serve basis in
                            that respective section.</p>
                    </div>
                    <!-- @if (commonService._selectedCategory()==='Event') { -->
                    <div class="py-3">
                        <h3>Artists</h3>
                        <div class="img-container d-flex gap-1">
                            @for (item of eventDetails?.cast; track $index) {
                            <div class="d-flex flex-column gap-2">
                                <img [src]="commonService.getImageFromBase64(item.castImg)" [alt]="item.castImg"
                                    class="rounded-4 w-75 h-75">
                                <h6 class="m-0">{{item.actorName}}</h6>
                            </div>
                            }
                        </div>
                    </div>
                    <!-- } -->
                    <h4 class="py-1">M-Ticket</h4>
                    <div class="w-75 rounded-4 d-flex align-items-center p-4 shadow-sm m_ticket">
                        <i class="fa fa-ticket fs-1 text-danger" aria-hidden="true"></i>
                        <p class="px-3 my-0"> Contactless Ticketing & Fast-track Entry with M-ticket.</p>
                    </div>
                    <h3 class="py-3" (click)="openCityModal(serviceModal)">Terms & Conditions <span>></span></h3>
                </div>
                <div class="col-3 side_card_details">
                    <div class="border h-100 rounded-4 bg-white ">
                        <div class="d-flex p-4 flex-column gap-2">

                            <div class="d-flex align-items-center gap-3">
                                <i class="fa fa-hourglass-start" aria-hidden="true"></i>
                                <span>{{eventDetails?.startDate}}</span>
                            </div>

                            <div class="d-flex align-items-center gap-3">
                                <i class="fa fa-hourglass-end" aria-hidden="true"></i>
                                <span>{{eventDetails?.endDate}}</span>
                            </div>

                            <div class="d-flex align-items-center gap-3">
                                <i class="fa fa-clock-o" aria-hidden="true"></i>
                                <span>{{eventDetails?.starttime}}</span>
                            </div>

                            <div class="d-flex align-items-center gap-3">
                                <i class="fa fa-hourglass-half" aria-hidden="true"></i>
                                <span>{{eventDetails?.runTime| duration}}</span>
                            </div>

                            <div class="d-flex align-items-center gap-3">
                                <i class="fa fa-users" aria-hidden="true"></i>
                                <span>Age Limit {{eventDetails?.ageLimit}}yrs +</span>
                            </div>

                            <div class="d-flex align-items-center gap-2 overflow-hidden  ">
                                <i class="fa fa-language" aria-hidden="true"></i>
                                @for (lang of eventDetails?.languages; track $index) {
                                <span>{{lang}}</span>
                                }
                            </div>

                            <div class="d-flex align-items-center gap-3">
                                <img src="https://assets-in.bmscdn.com/nmcms/synopsis/genre.png" alt="genre"
                                    style="width: 20px; height:20px;">
                                <span>{{eventDetails?.categories}}</span>
                            </div>

                            <div class="d-flex align-items-center gap-3">
                                <i class="fa fa-map-marker" aria-hidden="true"></i>
                                <span>{{eventDetails?.venueName?.[0]}}</span>
                            </div>
                            @if(authService.userDetailsSignal()?.role == 'ADMIN'){
                            <button class="d-flex align-items-center gap-3 btn btn-secondary "
                                (click)="handleDeleteEvent(confirmDeleteModal)">Delete</button>
                            }
                            <hr>
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="gap-2">
                                    <h5 class="">â‚¹{{eventDetails?.pricelist?.[0]}} onwards</h5>
                                     @if(getToday()<=eventDetails?.endDate) {
                                    <span>{{eventDetails?.moreFilters?.[0]}}</span>
                                     }
                                </div>
                                @if(getToday()<=eventDetails?.endDate) { 
                                    <button
                                    (click)="openConfirmModal(confirmModal)"
                                    (click)="getToday()" 
                                    class="book_now_btn">Book
                                    now</button>
                                    }
                                    @else if(getToday()>=eventDetails?.startDate){
                                    <button (click)="getToday()" (click)="eventClosed(closedModal)" class="book_now_btn">Book
                                        now</button>
                                    }
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="top_bar d-flex justify-content-center align-items-center bg-white border shadow-sm"
    [class.show]="showHeader">
    <div class="col-8 d-flex align-items-center gap-3 py-3">
        <h3>{{eventDetails?.name}}</h3> <span><i class="fa fa-share-alt fs-3" aria-hidden="true"
                (click)="openShareModal(shareModal)"></i>
        </span>
    </div>
</div>

<ng-template #serviceModal let-modal>
    <div class="modal-header border-bottom-0">
        <div class="col-12 d-flex justify-content-between align-itmes-center">
            <h2>Terms & Conditions</h2>

            <i class="fs-4 fa fa-times-circle-o p-2" aria-hidden="true" (click)="closemodal()"></i>
        </div>
    </div>
    <div class="modal-body p-0">
        <div class="px-2">
            <p>1. Tickets once booked cannot be exchanged or refunded.</p>
            <p>2. An Internet handling fee per ticket may be levied. Please check the total amount before payment</p>
            <p>3. We recommend that you arrive at-least 30 minutes prior at the venue for a seamless entry </p>
            <p>4. It is mandatory to wear masks at all times and follow social distancing norms</p>
            <p>5. Please do not purchase tickets if you feel sick</p>
            <p>6. Unlawful resale (or attempted unlawful resale) of a ticket would lead to seizure or cancellation of
                that ticket without refund or other compensation</p>
            <p>7. Rights of admission reserved</p>
            <p>8. These terms and conditions are subject to change from time to time at the discretion of the organizer
            </p>
            <p>9. Use any mobile application of your choice like GoogleFit, Strava, RunKeeper etc and submit a
                screenshot of your activity. </p>
        </div>
    </div>
</ng-template>

<!-- Share Modal Template -->
<ng-template #shareModal let-modal>
    <div class="modal-header border-bottom-0">
        <div class="col-12 d-flex justify-content-between align-itmes-center">
            <h3>Share</h3>
            <i class="fs-4 fa fa-times-circle-o p-2" aria-hidden="true" (click)="closemodal()"></i>
        </div>
    </div>
    <div class="modal-body p-0">
        <div class="border-bottom">
            <div class="box_container px-3 d-flex justify-content-between align-items-center py-3 px-3">
                <p class="m-0">Facebook</p>
                <a href="https://www.facebook.com" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
            </div>
        </div>
        <div class="border-bottom">
            <div class="box_container px-3 d-flex justify-content-between align-items-center py-3 px-3">
                <p class="m-0">X (Formerly Twitter)</p>
                <i class="fa fa-twitter" aria-hidden="true"></i>
            </div>
        </div>
        <div class="border-bottom">
            <div class="box_container px-3 d-flex justify-content-between align-items-center py-3 px-3">
                <p class="m-0">Copy Link</p>
                <i class="fa fa-clipboard" aria-hidden="true" (click)="getCurrentPath()"></i>
            </div>
        </div>
    </div>
</ng-template>

<!-- Confirm Modal Template -->
<ng-template #confirmModal let-modal>
    <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 ">
      <div class="modal-header justify-content-center">
        <h4 class="modal-title" id="loginPopupLabel">Login Required</h4>
      </div>

      <div class="modal-body border-0 text-center">
        <p>Please log in to book this event.</p>
      </div>
      <div class="modal-footer border-0 justify-content-center">
        <button type="button" class="btn btn-secondary" (click)="modal.dismiss()">Cancel</button>
        <button type="button" class="btn btn-danger" (click)="modal.close('login')">Log In</button>
      </div>
    </div>
  </div>
</ng-template>

<!-- Event Closed Modal Template -->
<ng-template #closedModal let-modal>
  <div class="modal-header border-0 justify-content-center">
    <h5 class="modal-title" id="modal-basic-title">Event Closed</h5>
  </div>

  <div class="modal-body text-center">
    <p>Sorry, this event is already closed.</p>
  </div>

  <div class="modal-footer border-0 justify-content-center">
    <button class="btn btn-danger" (click)="modal.close()">OK</button>
  </div>
</ng-template>
 

<!-- Confirm Delete Modal Template -->
<ng-template #confirmDeleteModal let-modal>
  <div class="modal-header border-0 justify-content-center">
    <h5 class="modal-title" id="modal-basic-title">Confirm Deletion</h5>
  </div>

  <div class="modal-body text-center">
    <p>Are you sure you want to delete this event?</p>
  </div>

  <div class="modal-footer border-0 justify-content-center">
    <button type="button" class="btn btn-light" (click)="modal.dismiss()">Cancel</button>
    <button type="button" class="btn btn-danger" (click)="modal.close('confirm')">Delete</button>
  </div>
</ng-template>
}